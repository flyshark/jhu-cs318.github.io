---
layout: default
title: Project 1--Source Files
---

<A NAME="Project 1 Source Files"></A>
<HR SIZE="6">
<H3><a href="project1.html">Project 1</a> Source Files </H3>
<!--docid::SEC18::-->

<DL COMPACT class="source-listing">
<DT><Q><TT>loader.S</TT></Q>
<DD><DT><Q><TT>loader.h</TT></Q>
<DD>The kernel loader.  Assembles to 512 bytes of code and data that the
PC BIOS loads into memory and which in turn finds the kernel on disk,
loads it into memory, and jumps to <CODE>start()</CODE> in <Q><TT>start.S</TT></Q>.
See section <A HREF="pintos_6.html#SEC92">A.1.1 The Loader</A>, for details.  You should not need to look at
this code or modify it.
<P>

</P>
<DT><Q><TT>start.S</TT></Q>
<DD>Does basic setup needed for memory protection and 32-bit
operation on 80<VAR>x</VAR>86 CPUs.  Unlike the loader, this code is
actually part of the kernel.  See section <A HREF="pintos_6.html#SEC93">A.1.2 Low-Level Kernel Initialization</A>,
for details.
<P>

</P>
<DT><Q><TT>kernel.lds.S</TT></Q>
<DD>The linker script used to link the kernel.  Sets the load address of
the kernel and arranges for <Q><TT>start.S</TT></Q> to be near the beginning
of the kernel image.  See section <A HREF="pintos_6.html#SEC92">A.1.1 The Loader</A>, for details. Again, you
should not need to look at this code
or modify it, but it's here in case you're curious.
<P>

</P>
<DT><Q><TT>init.c</TT></Q>
<DD><DT><Q><TT>init.h</TT></Q>
<DD>Kernel initialization, including <CODE>main()</CODE>, the kernel's &quot;main
program.&quot;  You should look over <CODE>main()</CODE> at least to see what
gets initialized.  You might want to add your own initialization code
here.  See section <A HREF="pintos_6.html#SEC94">A.1.3 High-Level Kernel Initialization</A>, for details.
<P>

</P>
<DT><Q><TT>thread.c</TT></Q>
<DD><DT><Q><TT>thread.h</TT></Q>
<DD>Basic thread support.  Much of your work will take place in these files.
<Q><TT>thread.h</TT></Q> defines <CODE>struct thread</CODE>, which you are likely to modify
in all four projects.  See <A HREF="pintos_6.html#SEC97">A.2.1 <CODE>struct thread</CODE></A> and <A HREF="pintos_6.html#SEC96">A.2 Threads</A> for
more information.
<P>

</P>
<DT><Q><TT>switch.S</TT></Q>
<DD><DT><Q><TT>switch.h</TT></Q>
<DD>Assembly language routine for switching threads.  Already discussed
above.  See section <A HREF="pintos_6.html#SEC98">A.2.2 Thread Functions</A>, for more information.
<P>

</P>
<DT><Q><TT>palloc.c</TT></Q>
<DD><DT><Q><TT>palloc.h</TT></Q>
<DD>Page allocator, which hands out system memory in multiples of 4 kB
pages.  See section <A HREF="pintos_6.html#SEC112">A.5.1 Page Allocator</A>, for more information.
<P>

</P>
<DT><Q><TT>malloc.c</TT></Q>
<DD><DT><Q><TT>malloc.h</TT></Q>
<DD>A simple implementation of <CODE>malloc()</CODE> and <CODE>free()</CODE> for
the kernel.  See section <A HREF="pintos_6.html#SEC113">A.5.2 Block Allocator</A>, for more information.
<P>

</P>
<DT><Q><TT>interrupt.c</TT></Q>
<DD><DT><Q><TT>interrupt.h</TT></Q>
<DD>Basic interrupt handling and functions for turning interrupts on and
off.  See section <A HREF="pintos_6.html#SEC107">A.4 Interrupt Handling</A>, for more information.
<P>

</P>
<DT><Q><TT>intr-stubs.S</TT></Q>
<DD><DT><Q><TT>intr-stubs.h</TT></Q>
<DD>Assembly code for low-level interrupt handling.  See section <A HREF="pintos_6.html#SEC108">A.4.1 Interrupt Infrastructure</A>, for more information.
<P>

</P>
<DT><Q><TT>synch.c</TT></Q>
<DD><DT><Q><TT>synch.h</TT></Q>
<DD>Basic synchronization primitives: semaphores, locks, condition
variables, and optimization barriers.  You will need to use these for
synchronization in all
four projects.  See section <A HREF="pintos_6.html#SEC100">A.3 Synchronization</A>, for more information.
<P>

</P>
<DT><Q><TT>io.h</TT></Q>
<DD>Functions for I/O port access.  This is mostly used by source code in
the <Q><TT>devices</TT></Q> directory that you won't have to touch.
<P>

</P>
<DT><Q><TT>vaddr.h</TT></Q>
<DD><DT><Q><TT>pte.h</TT></Q>
<DD>Functions and macros for working with virtual addresses and page table
entries.  These will be more important to you in project 3.  For now,
you can ignore them.
<P>

</P>
<DT><Q><TT>flags.h</TT></Q>
<DD>Macros that define a few bits in the 80<VAR>x</VAR>86 &quot;flags&quot; register.
Probably of no interest.  See [ <A HREF="pintos_13.html#IA32-v1">IA32-v1</A>], section 3.4.3, &quot;EFLAGS
Register,&quot; for more information.
</DL>
<P>

<A NAME="devices code"></A>
<HR SIZE="6">
<A NAME="SEC19"></A>
<H4><Q><TT>devices</TT></Q> code </H4>
<!--docid::SEC19::-->
<P>

The basic threaded kernel also includes these files in the
<Q><TT>devices</TT></Q> directory:
</P>
<P>

</P>
<DL COMPACT class="source-listing">
<DT><Q><TT>timer.c</TT></Q>
<DD><DT><Q><TT>timer.h</TT></Q>
<DD>System timer that ticks, by default, 100 times per second.  You will
modify this code in this project.
<P>

</P>
<DT><Q><TT>vga.c</TT></Q>
<DD><DT><Q><TT>vga.h</TT></Q>
<DD>VGA display driver.  Responsible for writing text to the screen.
You should have no need to look at this code.  <CODE>printf()</CODE>
calls into the VGA display driver for you, so there's little reason to
call this code yourself.
<P>

</P>
<DT><Q><TT>serial.c</TT></Q>
<DD><DT><Q><TT>serial.h</TT></Q>
<DD>Serial port driver.  Again, <CODE>printf()</CODE> calls this code for you,
so you don't need to do so yourself.
It handles serial input by passing it to the input layer (see below).
<P>

</P>
<DT><Q><TT>block.c</TT></Q>
<DD><DT><Q><TT>block.h</TT></Q>
<DD>An abstraction layer for <EM>block devices</EM>, that is, random-access,
disk-like devices that are organized as arrays of fixed-size blocks.
Out of the box, Pintos supports two types of block devices: IDE disks
and partitions.  Block devices, regardless of type, won't actually be
used until project 2.
<P>

</P>
<DT><Q><TT>ide.c</TT></Q>
<DD><DT><Q><TT>ide.h</TT></Q>
<DD>Supports reading and writing sectors on up to 4 IDE disks.
<P>

</P>
<DT><Q><TT>partition.c</TT></Q>
<DD><DT><Q><TT>partition.h</TT></Q>
<DD>Understands the structure of partitions on disks, allowing a single
disk to be carved up into multiple regions (partitions) for
independent use.
<P>

</P>
<DT><Q><TT>kbd.c</TT></Q>
<DD><DT><Q><TT>kbd.h</TT></Q>
<DD>Keyboard driver.  Handles keystrokes passing them to the input layer
(see below).
<P>

</P>
<DT><Q><TT>input.c</TT></Q>
<DD><DT><Q><TT>input.h</TT></Q>
<DD>Input layer.  Queues input characters passed along by the keyboard or
serial drivers.
<P>

</P>
<DT><Q><TT>intq.c</TT></Q>
<DD><DT><Q><TT>intq.h</TT></Q>
<DD>Interrupt queue, for managing a circular queue that both kernel
threads and interrupt handlers want to access.  Used by the keyboard
and serial drivers.
<P>

</P>
<DT><Q><TT>rtc.c</TT></Q>
<DD><DT><Q><TT>rtc.h</TT></Q>
<DD>Real-time clock driver, to enable the kernel to determine the current
date and time.  By default, this is only used by <Q><TT>thread/init.c</TT></Q>
to choose an initial seed for the random number generator.
<P>

</P>
<DT><Q><TT>speaker.c</TT></Q>
<DD><DT><Q><TT>speaker.h</TT></Q>
<DD>Driver that can produce tones on the PC speaker.
<P>

</P>
<DT><Q><TT>pit.c</TT></Q>
<DD><DT><Q><TT>pit.h</TT></Q>
<DD>Code to configure the 8254 Programmable Interrupt Timer.  This code is
used by both <Q><TT>devices/timer.c</TT></Q> and <Q><TT>devices/speaker.c</TT></Q>
because each device uses one of the PIT's output channel.
</DL>
<P>

<A NAME="lib files"></A>
<HR SIZE="6">
<A NAME="SEC20"></A>
<H4><Q><TT>lib</TT></Q> files </H4>
<!--docid::SEC20::-->
<P>

Finally, <Q><TT>lib</TT></Q> and <Q><TT>lib/kernel</TT></Q> contain useful library
routines.  (<Q><TT>lib/user</TT></Q> will be used by user programs, starting in
project 2, but it is not part of the kernel.)  Here's a few more
details:
</P>
<P>

</P>
<DL COMPACT class="source-listing">
<DT><Q><TT>ctype.h</TT></Q>
<DD><DT><Q><TT>inttypes.h</TT></Q>
<DD><DT><Q><TT>limits.h</TT></Q>
<DD><DT><Q><TT>stdarg.h</TT></Q>
<DD><DT><Q><TT>stdbool.h</TT></Q>
<DD><DT><Q><TT>stddef.h</TT></Q>
<DD><DT><Q><TT>stdint.h</TT></Q>
<DD><DT><Q><TT>stdio.c</TT></Q>
<DD><DT><Q><TT>stdio.h</TT></Q>
<DD><DT><Q><TT>stdlib.c</TT></Q>
<DD><DT><Q><TT>stdlib.h</TT></Q>
<DD><DT><Q><TT>string.c</TT></Q>
<DD><DT><Q><TT>string.h</TT></Q>
<DD>A subset of the standard C library.  See section <A HREF="pintos_8.html#SEC140">C.2 C99</A>, for
information
on a few recently introduced pieces of the C library that you might
not have encountered before.  See section <A HREF="pintos_8.html#SEC141">C.3 Unsafe String Functions</A>, for
information on what's been intentionally left out for safety.
<P>

</P>
<DT><Q><TT>debug.c</TT></Q>
<DD><DT><Q><TT>debug.h</TT></Q>
<DD>Functions and macros to aid debugging.  See section <A HREF="pintos_10.html#SEC145">E. Debugging Tools</A>, for
more information.
<P>

</P>
<DT><Q><TT>random.c</TT></Q>
<DD><DT><Q><TT>random.h</TT></Q>
<DD>Pseudo-random number generator.  The actual sequence of random values
will not vary from one Pintos run to another, unless you do one of
three things: specify a new random seed value on the <Q><SAMP>-rs</SAMP></Q>
kernel command-line option on each run, or use a simulator other than
Bochs, or specify the <Q><SAMP>-r</SAMP></Q> option to <CODE>pintos</CODE>.
<P>

</P>
<DT><Q><TT>round.h</TT></Q>
<DD>Macros for rounding.
<P>

</P>
<DT><Q><TT>syscall-nr.h</TT></Q>
<DD>System call numbers.  Not used until project 2.
<P>

</P>
<DT><Q><TT>kernel/list.c</TT></Q>
<DD><DT><Q><TT>kernel/list.h</TT></Q>
<DD>Doubly linked list implementation.  Used all over the Pintos code, and
you'll probably want to use it a few places yourself in project 1.
<P>

</P>
<DT><Q><TT>kernel/bitmap.c</TT></Q>
<DD><DT><Q><TT>kernel/bitmap.h</TT></Q>
<DD>Bitmap implementation.  You can use this in your code if you like, but
you probably won't have any need for it in project 1.
<P>

</P>
<DT><Q><TT>kernel/hash.c</TT></Q>
<DD><DT><Q><TT>kernel/hash.h</TT></Q>
<DD>Hash table implementation.  Likely to come in handy for project 3.
<P>

</P>
<DT><Q><TT>kernel/console.c</TT></Q>
<DD><DT><Q><TT>kernel/console.h</TT></Q>
<DD><DT><Q><TT>kernel/stdio.h</TT></Q>
<DD>Implements <CODE>printf()</CODE> and a few other functions.
</DL>
<P>

